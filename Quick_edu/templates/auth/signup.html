{% extends 'base/base.html' %}

{% block content %}
<h2>Sign Up</h2>

<form id="signupform" method="post" action="{% url 'signup' %}" enctype="multipart/form-data">
    {% load static %}
    {% csrf_token %}
    {% load widget_tweaks %}
    <div class="col-7">
        <!-- username -->
        <div class="input-group">
            <div class="input-group me-4">
                <h5>UserName:</h5>
            </div>
            <div class="form-group col">
                {{ form.username|add_class:"form-control border-2 border-warning" |attr:"placeholder:Enter Your Username" }}
            </div>
        </div>
            <div class="text-danger mb-3 " id="username-valid">{{ form.username.errors }}</div>
        
            <!-- firstname & lastname -->
            <div class="row col-lg">
                <div class=" col-md-6 input-group ">
                    <div class="input-group">
                        <h5>First Name: </h5>
                    </div>
                    {{ form.first_name|add_class:"form-control border-2 border-warning"|attr:"placeholder:Enter Your First Name" }}
                </div>
                <div class="text-danger mb-4 " id="fname-valid">{{ form.first_name.error }}</div>
            </div>
            <div class="row col-lg">
                <div class="col-md-6 input-group ">
                    <div class="input-group">
                        <h5>Last Name: </h5>
                    </div>
                    {{ form.last_name|add_class:"form-control border-2 border-warning"|attr:"placeholder:Enter Your Last Name" }}
                </div>
                <div class="text-danger mb-4 " id="lname-valid">{{ form.last_name.error }}</div>
            </div>
        <!-- email -->
        <div class="input-group">
            <div class="input-group me-4">
                <h5>Email Address:</h5>
            </div>
            <div class="form-group col">
                {{ form.email|add_class:"form-control border-2 border-warning"|attr:"placeholder:Enter Your Email Address" }}
            </div>
        </div>
        
            <div class="error text-danger mb-3 " id="email-valid">{{ user_form.email.errors }}</div>
        
        <!-- password -->
        <div class="input-group">
            <div class="input-group me-4">
                <h5>Password:</h5>
            </div>
            <div class="form-group col me-3">
                {{ form.password1|add_class:"form-control border-2 border-warning"|attr:"placeholder:Enter Your Password" }}
            </div>
            <span>
                <input type="checkbox" class="" onclick="id_password1.type = this.checked ? 'text' : 'password'">
            </span>
        </div>
        <div class="text-danger mb-4 " id="password-valid">{{ form.password1.error }}</div>
        <!-- re-pass -->
        <div class="input-group ">
            <div class="input-group me-4">
                <h5>Confirm Password:</h5>
            </div>
            <div class="form-group col me-3">
                {{ form.password2|add_class:"form-control border-2 border-warning"|attr:"placeholder:Enter Your Confirm password" }}
            </div>
            <span>
                <input type="checkbox" class="fs-3 " onclick="id_password2.type = this.checked ? 'text' : 'password'">
            </span>
        </div>
        <div class="text-danger mb-3" id="re-pass-valid">{{ form.password2.error }}</div>
        <!-- gender -->
        <div class="input-group ">
            <h5 class="">Gender:</h5>
            <div class="ms-2 fs-5">
                {{form.gender}}
            </div>
        </div>
        <div class="text-danger mb-3" id="gender-valid"></div>
        <!-- birth date -->
        <div class="input-group row">
            <h5>Birth Date:</h5>
            {{ form.birth_date|add_class:"form-control border-2 border-warning ms-3" }}
            <div class="text-danger mb-3" id="birthdate-valid">{{ form.birth_date.error }}</div>
        </div>
        {% load i18n %}
        {% get_available_languages as languages %}
        <!-- country -->
        <div class="input-group text-black select row">
            <h5>Country:</h5>
            <select class="form-select border-2 text-black border-warning ms-3" id="country" aria-label="Default select example" name="country">
                {% for con in form.country %}
                    {{ con }}
                {% endfor %}
            </select>
        </div>
        <div class="text-danger mb-3" id="country-valid">{{ form.country.error }}</div>
        <!-- profile picture -->
        <div class="input-group row">
            <h5>Profile Picture:</h5>
            {{ form.profile_picture|add_class:"form-control border-2 border-warning ms-3"}}
            <div class="text-danger mb-3" id="profile-valid">{{ form.profile_picture.error }}</div>
        </div>
        <!-- resume -->
        <div class="input-group row">
            <h5>Resume:</h5>
            {{ form.resume|add_class:"form-control border-2 border-warning ms-3"|attr:"accept:.doc, .docx, .pdf" }}
            <div class="text-danger mb-3" id="resume-valid">
                {{ form.resume.error }}
            </div>
        </div>
        <!-- mobile_number -->
        <div class="input-group row">
            <h5>Mobile Number:</h5>
            {{ form.mobile_number|add_class:"form-control border-2 border-warning ms-3"|attr:"placeholder:Enter Your Mobile Number" }}
            <div class="text-danger mb-3" id="mobile-valid">
                {{ form.mobile_number.error }}
            </div>
        </div>
        <!-- Register -->
        <button type="submit" id="register" class="btn btn-warning w-25 p-3" value="OK">Sign Up</button>
    </div>
</form>

<script src="{% static 'js/jquery-3.7.1.min.js' %}"></script>
<script src="{% static 'js/additional-methods.js' %}"></script>
<script src="{% static 'js/jquery.validate.js' %}"></script>
<script src="{% static 'js/signup.js' %}"></script>


<script>
    const mutation = `
    mutation CreateUserMutation($username: String!, $password: String!, $email: String!, $ , ) {
        createUser(username: $username, password: $password, email: $email, phone: $phone, address: $address) {
            user {
                id
                username
                email
            }
            profile {
                id
                phone
                address
            }
        }
    }
`;

const variables = {
    username: 'testuser',
    password: 'password123',
    email: 'test@example.com',
    phone: '123-456-7890',
    address: '123 Main St'
};

fetch('/graphql', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        query: mutation,
        variables: variables,
    }),
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error('Error:', error));
</script>
{% endblock %}